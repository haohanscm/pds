webpackJsonp([18],{"/9ap":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("5JDp"),i=s("4YfN"),n=s.n(i),a={data:function(){return{request:new o.a,goodsIndex:"",checkList:[],modelList:[],spuGoods:{},skuGoods:{},goodsModelIndex:"",showAdd:!1}},components:{},props:{goodsList:Array,title:{type:Object}},watch:{},created:function(){},methods:{handleDetail:function(e,t){var s=this;this.$confirm("您确认要删除该商品吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){s.deleteDetail(e.id,t)})},deleteDetail:function(e){var t=this,s=(arguments.length>1&&void 0!==arguments[1]&&arguments[1],{buyId:this.title.buyId,buyerId:this.title.buyerId,buyOrderDetailList:[{id:e,delFlag:"1"}]});this.request.modifyList(s).then(function(e){200==e.code?t.$message.success(e.msg):t.$message.warning(e.msg),t.purchaseList()})},searchGoodsByName:function(){var e=this;return function(t){if(""!==t){var s={goodsName:t};e.getGoodsList(s).then(function(t){e.checkList=t})}}},getGoodsList:function(e){return e.pageSize=20,e.buyerId=this.title.buyerId,e.buySeq=this.title.buySeq,this.request.getGoodsList(e).then(function(e){if(200==e.code)return e.ext.list;console.log("商品列表获取错误",e.msg)})},openShow:function(){this.resetAddGood(),this.showAdd=!0},closeShow:function(){this.resetAddGood(),this.showAdd=!1},resetAddGood:function(){this.goodsIndex="",this.checkList=[],this.modelList=[],this.spuGoods={},this.skuGoods={},this.goodsModelIndex=""},onGoodsSelectChange:function(){"number"==typeof this.goodsIndex?(this.spuGoods=this.checkList[this.goodsIndex],this.goodsModelIndex=0,this.onGoodsModelSelectChange()):(this.skuGoods={},this.spuGoods={},this.goodsModelIndex="")},onGoodsModelSelectChange:function(){this.skuGoods=this.spuGoods.goodsModelList[this.goodsModelIndex],this.skuGoods.goodsName=this.spuGoods.goodsName},handleChangeNum:function(e){if(/^[0-9]+(\.[0-9]{1,2})?$/.test(e.goodsNum))if(/^[0-9]+(\.[0-9]{1,2})?$/.test(e.buyPrice)){var t={};t.buyOrderDetailList=[e],this.changeNum(t)}else this.$message.error("价格有误,请输入数字,最多2位小数");else this.$message.error("数量有误,请输入数字,最多2位小数")},addBuyOrder:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$confirm("您确认要新增该商品吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.buyId=e.title.buyId,t.buyerId=e.title.buyerId;var s=n()({},e.skuGoods);s.goodsId=s.id,s.id="",s.goodsNum?(t.buyOrderDetailList=[s],e.request.modifyList(t).then(function(t){200==t.code?(e.$message.success(t.msg),e.purchaseList()):(e.skuGoods={},e.$message.warning(t.msg)),e.closeShow()})):e.$message.warning("请输入商品数量")})},changeNum:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};t.buyId=this.title.buyId,t.buyerId=this.title.buyerId,this.request.modifyList(t).then(function(t){200==t.code?e.$message.success(t.msg):(e.$message.warning(t.msg),e.purchaseList())})},updateBuyOrder:function(){var e=this;if(!this.goodsList||this.goodsList.length<1)this.$message.error("无采购单明细信息");else{var t={buyId:this.title.buyId,buyerId:this.title.buyerId,deliveryTime:this.title.deliveryTime,buySeq:this.title.buySeq,needNote:this.title.needNote,remarks:this.title.remarks,buyOrderDetailList:[this.goodsList[0]]};this.request.modifyList(t).then(function(t){200==t.code?e.$message.success(t.msg):(e.$message.warning(t.msg),e.purchaseList())})}},purchaseList:function(){var e=this;this.request.purchaseList({buyId:this.title.buyId,pageSize:100}).then(function(t){200==t.code?e.changeGoodsList(t.ext.list):(e.changeGoodsList([]),e.$message.warning(t.msg))}).catch(function(t){e.$message.error(t)})},changeGoodsList:function(e){this.$emit("change-list",e)},showPhoto:function(e){this.spuGoods.thumbUrl=e}}},r={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",[s("el-col",{attrs:{span:4}},[e._v("\n            采购商:"+e._s(e.title.buyerName)+"\n        ")]),e._v(" "),s("el-col",{attrs:{span:4}},[e._v("\n            采购单编号:"+e._s(e.title.buyId)+"\n        ")]),e._v(" "),s("el-col",{attrs:{span:4}},[e._v("\n            状态:"+e._s(e.$dic.buyerOption[e.title.status])+"\n        ")]),e._v(" "),s("el-col",{attrs:{span:6}},[s("div",[e._v("配送日期:\n                "),s("el-date-picker",{staticClass:"date-field",attrs:{editable:!1,type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.title.deliveryTime,callback:function(t){e.$set(e.title,"deliveryTime",t)},expression:"title.deliveryTime"}})],1)]),e._v(" "),s("el-col",{attrs:{span:6}},[s("div",[e._v("批次:\n                "),s("el-select",{staticClass:"select-field",attrs:{"value-key":"value",clearable:"",placeholder:"请选择"},model:{value:e.title.buySeq,callback:function(t){e.$set(e.title,"buySeq",t)},expression:"title.buySeq"}},e._l(e.$dic.buySeqOptions,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1)])],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:2}},[e._v("需求信息:")]),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:1,maxRows:4},maxlength:"100"},model:{value:e.title.needNote,callback:function(t){e.$set(e.title,"needNote",t)},expression:"title.needNote"}})],1)],1),e._v(" "),s("el-row",{attrs:{gutter:20}},[s("el-col",{attrs:{span:2}},[e._v("备注信息:")]),e._v(" "),s("el-col",{attrs:{span:12}},[s("el-input",{attrs:{type:"textarea",autosize:{minRows:1,maxRows:4},maxlength:"100"},model:{value:e.title.remarks,callback:function(t){e.$set(e.title,"remarks",t)},expression:"title.remarks"}})],1),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.updateBuyOrder()}}},[e._v("提交修改")])],1)],1),e._v(" "),s("el-table",{staticStyle:{"min-width":"100%"},attrs:{data:e.goodsList,stripe:"",height:"350px"}},[s("el-table-column",{attrs:{type:"index",width:"50",fixed:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"goodsName",label:"商品名称","min-width":"80",fixed:"",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"goodsModel",label:"规格","min-width":"80",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"unit",label:"单位","min-width":"80",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"goodsNum",label:"商品数","min-width":"150",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input-number",{attrs:{size:"mini",max:1e6,min:0},model:{value:t.row.goodsNum,callback:function(s){e.$set(t.row,"goodsNum",s)},expression:"scope.row.goodsNum"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"marketPrice",label:"市场价","min-width":"80",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"buyPrice",label:"采购价","min-width":"150",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input-number",{attrs:{size:"mini",precision:2,step:.1,max:1e6,min:0},model:{value:t.row.buyPrice,callback:function(s){e.$set(t.row,"buyPrice",s)},expression:"scope.row.buyPrice"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"remarks",label:"备注信息","min-width":"150"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-input",{attrs:{maxlength:"100"},model:{value:t.row.remarks,callback:function(s){e.$set(t.row,"remarks",s)},expression:"scope.row.remarks"}})]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"totalPrice",label:"操作","min-width":"180",fixed:"right"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{type:"primary"},on:{click:function(s){return e.handleChangeNum(t.row)}}},[e._v("提交修改")]),e._v(" "),s("el-button",{attrs:{type:"danger"},on:{click:function(s){return e.handleDetail(t.row,t.$index)}}},[e._v("删除")])]}}])})],1),e._v(" "),s("el-row",[s("el-button",{directives:[{name:"show",rawName:"v-show",value:e.showAdd,expression:"showAdd"}],attrs:{type:"primary",plain:"",icon:"el-icon-hh-add1"},on:{click:e.addBuyOrder}},[e._v("提交商品\n        ")]),e._v(" "),s("el-button",{directives:[{name:"show",rawName:"v-show",value:!e.showAdd,expression:"!showAdd"}],attrs:{type:"primary",plain:"",icon:"el-icon-hh-add1"},on:{click:e.openShow}},[e._v("新增商品\n        ")])],1),e._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.showAdd,expression:"showAdd"}],attrs:{gutter:20}},[s("el-col",{attrs:{span:1.5}},[e._v("\n            商品:\n        ")]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{filterable:"",clearable:"","default-first-option":"",remote:"","remote-method":e.searchGoodsByName(),placeholder:"请输入商品名称"},on:{change:function(t){return e.onGoodsSelectChange()}},model:{value:e.goodsIndex,callback:function(t){e.goodsIndex=t},expression:"goodsIndex"}},e._l(e.checkList,function(t,o){return s("el-option",{key:t.id,attrs:{label:t.goodsName,value:o},nativeOn:{mouseover:function(s){return e.showPhoto(t.thumbUrl)}}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:1.5}},[e._v("\n            规格:\n        ")]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-select",{attrs:{width:"100",placeholder:"选择商品规格"},on:{change:function(t){return e.onGoodsModelSelectChange()}},model:{value:e.goodsModelIndex,callback:function(t){e.goodsModelIndex=t},expression:"goodsModelIndex"}},e._l(e.spuGoods.goodsModelList,function(e,t){return s("el-option",{key:e.id,attrs:{label:e.modelName,value:t}})}),1)],1),e._v(" "),s("el-col",{attrs:{span:2}},[e._v("\n            采购数量:\n        ")]),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-input",{attrs:{placeholder:"请输入数量",maxlength:"10"},model:{value:e.skuGoods.goodsNum,callback:function(t){e.$set(e.skuGoods,"goodsNum",t)},expression:"skuGoods.goodsNum"}})],1),e._v(" "),s("el-col",{attrs:{span:2}},[e._v("\n            单位:"+e._s(e.skuGoods.modelUnit)+"\n        ")])],1),e._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.showAdd,expression:"showAdd"}],attrs:{gutter:20}},[s("div",{directives:[{name:"show",rawName:"v-show",value:e.skuGoods.purchasePrice,expression:"skuGoods.purchasePrice"}]},[s("el-col",{attrs:{span:3}},[e._v("\n            市场价:"+e._s(e.skuGoods.purchasePrice)+" 元/"+e._s(e.skuGoods.modelUnit||"单位")+"\n        ")]),e._v(" "),s("el-col",{attrs:{span:5}},[e._v("\n            采购价:"),s("el-input",{staticClass:"input-num",attrs:{placeholder:"输入采购价",maxlength:"10"},model:{value:e.skuGoods.buyPrice,callback:function(t){e.$set(e.skuGoods,"buyPrice",t)},expression:"skuGoods.buyPrice"}}),e._v(" 元/"+e._s(e.skuGoods.modelUnit)+"\n        ")],1)],1),e._v(" "),s("el-col",{attrs:{span:2}},[e._v("\n            备注信息:\n        ")]),e._v(" "),s("el-col",{attrs:{span:5}},[s("el-input",{staticStyle:{"max-width":"400px"},attrs:{placeholder:"请输入备注信息",maxlength:"50"},model:{value:e.skuGoods.remarks,callback:function(t){e.$set(e.skuGoods,"remarks",t)},expression:"skuGoods.remarks"}})],1)],1),e._v(" "),s("el-row",{directives:[{name:"show",rawName:"v-show",value:e.showAdd,expression:"showAdd"}],attrs:{gutter:20}},[s("el-col",{attrs:{span:6,id:"show-photo"}},[s("img",{attrs:{src:e.spuGoods.thumbUrl,alt:"",width:"100px"}})])],1)],1)},staticRenderFns:[]};var l=s("C7Lr")(a,r,!1,function(e){s("Flkq")},"data-v-44ed748b",null).exports,d=s("8uth"),u=s.n(d),c={data:function(){return{options:this.$dic.buySeqOptions,pmName:this.$utils.getCookie("pmName"),tabStatus:"first",shipfee:0,pageSize:20,pageNo:1,total:0,totalPage:0,totalKinds:0,list:[],activeName:"second"}},props:{value:Object,conciseList:Array},watch:{value:{handler:function(e,t){e.shipFee||(e.shipFee=0)},deep:!0,immediate:!0},conciseList:{handler:function(e,t){e.forEach(function(e){e.charge=e.goodsNum*(e.buyPrice||e.purchasePrice),e.charge=e.charge.toFixed(2)})},deep:!0,immediate:!0}},computed:{totalPrice:function(){var e=0;return this.conciseList.forEach(function(t){e+=+t.charge||0}),e.toFixed(2)},totalCharge:function(){return(+this.totalPrice+ +this.shipfee).toFixed(2)},totalNum:function(){var e=0;return this.conciseList.forEach(function(t){t.goodsNum&&(e+=+t.goodsNum)}),e.toFixed(2)}},methods:{exportExcel:function(e,t,s,o){u.a.getExcel(e,t,s,o)},checkSupplierList:function(){this.fetchBuyOrderList()},printTable:function(e){var t=document.getElementById(e).innerHTML,s=window.open("","打印"),o="<html>"+this.printHeadHtml()+"<body><div>"+t+"</div></body></html>";s.document.write(o),s.document.close(),s.window.onload=function(){s.window.print()}},printBodyHtml:function(e){return"<div>"+document.getElementById(e).innerHTML+"</div>"},printHeadHtml:function(){return"<head><meta http-equiv='Content-Type' content='text/html; charset=utf-8'><style scoped lang='scss'>\n    body {\n        font-family: 'SimHei', 'SimHei', 'Times New Roman';\n        font-size: 16px;\n    }\n    caption {\n        font-size: 18px;\n        font-weight: 800;\n        padding: 8px;\n    }\n    .blod {\n        font-weight: 500;\n    }\n    .padRight-cons {\n        text-align: center;\n        margin: 0 auto;\n        writing-mode: vertical-lr;\n        font-size: 14px;\n    }\n    .footer {\n        display: flex;\n    }\n    .footer .right {\n        padding-left: 30px;\n        padding-top: 20px;\n        padding-bottom: 20px;\n    }\n    .right p {\n        line-height: 39px;\n    }\n    .right .footer-sign {\n        display: flex;\n    }\n    .footer-sign div {\n        margin-top: 8px;\n        margin-right: 200px;\n        margin-left: 20px;\n    }\n    table {\n        border-spacing: 0px;\n        border-collapse: collapse;\n        border: 1px solid #000;\n        width: 100%;\n        text-align: center;\n        line-height: 100%;\n        background-color: #ffffff;\n    }\n    table td {\n        border: 1px solid #000;\n        padding: 8px;\n        max-width: 150px;\n        line-height: 100%;\n    }\n    table th {\n        border: 1px solid #000;\n        padding: 8px;\n        line-height: 100%;\n    }\n</style></head>"}}},h={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[s("el-tab-pane",{attrs:{label:"采购单",name:"second"}},[e.list?s("div",{attrs:{id:"buyOrder"}},[s("div",{staticStyle:{display:"flex","align-items":"center"}},[s("table",{attrs:{border:"1",id:"buy"}},[s("caption",[e._v(e._s(e.pmName)+"-采购单")]),e._v(" "),s("tbody",[s("tr",[s("td",{staticClass:"blod",attrs:{colspan:"2"}},[e._v("采购商名称")]),e._v(" "),s("td",{attrs:{colspan:"3"}},[e._v(e._s(e.value.buyerName))]),e._v(" "),s("td",{staticClass:"blod",attrs:{colspan:"1"}},[e._v("日期")]),e._v(" "),s("td",{attrs:{colspan:"2"}},[e._v(e._s(e.value.deliveryTime))])]),e._v(" "),s("tr",[s("td",{staticClass:"blod",attrs:{colspan:"2"}},[e._v("送货地址")]),e._v(" "),s("td",{attrs:{colspan:"6"}},[e._v(e._s(e.value.address))])]),e._v(" "),s("tr",[s("td",{attrs:{colspan:"9"}},[e._v(" ")])]),e._v(" "),s("tr",[s("td",{staticClass:"blod"},[e._v("序号")]),e._v(" "),s("td",{staticClass:"blod"},[e._v("采购单号")]),e._v(" "),s("td",{staticClass:"blod"},[e._v("商品名称")]),e._v(" "),s("td",{staticClass:"blod"},[e._v("规格")]),e._v(" "),s("td",{staticClass:"blod"},[e._v("单位")]),e._v(" "),s("td",{staticClass:"blod"},[e._v("采购数量")]),e._v(" "),s("td",{staticClass:"blod"},[e._v("单价(元)")]),e._v(" "),s("td",{staticClass:"blod"},[e._v("应收款(元)")])]),e._v(" "),e._l(e.conciseList,function(t,o){return s("tr",{key:o},[s("td",{staticClass:"blod"},[e._v(e._s(o+1))]),e._v(" "),s("td",[e._v(e._s(t.buyId))]),e._v(" "),s("td",[e._v(e._s(t.goodsName))]),e._v(" "),s("td",[e._v(e._s(t.goodsModel))]),e._v(" "),s("td",[e._v(e._s(t.unit))]),e._v(" "),s("td",[e._v(e._s(t.goodsNum))]),e._v(" "),s("td",[e._v(e._s(t.buyPrice))]),e._v(" "),s("td",[e._v(e._s(+t.charge||""))])])}),e._v(" "),s("tr",[s("td",{staticClass:"blod",attrs:{colspan:"2",rowspan:"2"}},[e._v("合计")]),e._v(" "),s("td",{staticClass:"blod",attrs:{colspan:"1"}},[e._v("商品种类")]),e._v(" "),s("td",{attrs:{colspan:"2"}},[e._v(e._s(e.conciseList.length))]),e._v(" "),s("td",{staticClass:"blod",attrs:{colspan:"1"}},[e._v("采购数量")]),e._v(" "),s("td",{attrs:{colspan:"2"}},[e._v(e._s(e.totalNum))])]),e._v(" "),s("tr",[s("td",{staticClass:"blod",attrs:{colspan:"1"}},[e._v("商品总价")]),e._v(" "),s("td",{attrs:{colspan:"5"}},[e._v(e._s(e.totalCharge)+"元")])])],2)]),e._v(" "),s("div",{staticClass:"padRight-cons"},[e._v("第一联（记账联）第二联（库房）第三联（采购商）")])]),e._v(" "),s("div",{staticClass:"footer"},[s("div",{staticClass:"right"},[s("div",{staticClass:"footer-sign"},[s("div",[e._v("签收人：")]),e._v(" "),s("div",[e._v("日期：")])])])])]):e._e(),e._v(" "),s("a",{attrs:{id:"bb"},on:{click:function(t){return e.exportExcel("buy","","采购单.xls","bb")}}},[e._v("导出excel")]),e._v("    \n            "),s("a",{on:{click:function(t){return e.printTable("buyOrder")}}},[e._v("打印")])])],1)],1)},staticRenderFns:[]};var p={data:function(){return{dialogTableVisible:!1,dialogPrint:!1,goodsList:[],totalGoods:0,goodsPage:{pageSize:20,pageNo:1},request:new o.a,checkedItem:{},activeName:"first",multipleSelection:[],headHtmlPrint:"",bodyHtmlPrint:""}},components:{vGoodsTable:l,vPrint:s("C7Lr")(c,h,!1,function(e){s("g6EX")},"data-v-00ccdec0",null).exports},props:{orderList:Array},watch:{},created:function(){},methods:{printAgain:function(){this.headHtmlPrint&&this.bodyHtmlPrint?this.printBatch(this.headHtmlPrint,this.bodyHtmlPrint):this.$message.warning("没有可重新打印的采购单")},printSelectOrder:function(){var e=this.multipleSelection;0!=e.length?(this.dialogPrint=!0,this.headHtmlPrint="",this.bodyHtmlPrint="",this.batchPrint(0,e,"","","",this.batchPrint,this.printBatch)):this.$message.warning("未选择需打印采购单")},batchPrint:function(e,t,s,o,i,n,a){var r=this;this.dialogPrint=!0;var l=t[e];this.checkedItem=l,e==t.length-1&&(s=this.$refs.printOrderTable.printHeadHtml()),this.request.purchaseList({buyId:l.buyId,pageSize:1e3}).then(function(d){r.$message.warning("采购单"+(e+1)+"  等待数据加载"),200==d.code?(r.goodsList=d.ext.list,r.totalGoods=d.ext.totalRows):(r.goodsList=[],r.totalGoods=0);var u=10*(r.totalGoods+1)>u;u=u>500?u:500;var c=r;setTimeout(function(){if(c.goodsList.length>0){var r=c.$refs.printOrderTable.printBodyHtml("buyOrder");i+="<p>#"+(e+1)+" 采购单 "+l.buyId+" 商品数 "+c.goodsList.length+"</p>",o=o+r+'<div style="height: 50px;page-break-after:always"></div>'}c.dialogPrint=!1,++e<t.length?n(e,t,s,o,i,n,a):(c.$notify({title:"打印的采购单信息:",dangerouslyUseHTMLString:!0,message:i,duration:0}),c.headHtmlPrint=s,c.bodyHtmlPrint=o,a(s,o))},u)})},printBatch:function(e,t){var s=window.open("","打印"),o="<html>"+e+"<body>"+t+"</body></html>";s.document.write(o),s.document.close(),s.window.onload=function(){s.window.print()}},handleSelectionChange:function(e){this.multipleSelection=e},buyOrderClose:function(e){this.$refs.buyOrderInfo.closeShow(),e()},printBuyOrder:function(e){var t=this,s={buyId:e.buyId};this.request.printBuyOrder(s).then(function(e){console.log("print",e),200==e.code?t.$message.success(e.msg):t.$message.warning("失败："+e.msg)})},checkDetail:function(e){this.checkedItem=e,this.purchaseList(e.buyId),this.dialogTableVisible=!0},printTable:function(e){this.checkedItem=e,this.purchaseList(e.buyId),this.dialogPrint=!0},handleDelete:function(e,t){var s=this;this.$confirm("您确认要取消"+e.buyerName+"的第"+e.buyId+"号订单吗？").then(function(t){s.modifyList({buyId:e.buyId,buyerId:e.buyerId,status:4})})},purchaseList:function(e){var t=this;this.request.purchaseList({buyId:e,pageSize:1e3}).then(function(e){200==e.code?(t.goodsList=e.ext.list,t.totalGoods=e.ext.totalRows):(t.goodsList=[],t.totalGoods=0,t.$message.warning(e.msg))}).catch(function(e){t.$message.error(e)})},modifyList:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.request.modifyList(t).then(function(t){200==t.code?(e.$message.success(t.msg),e.$emit("refreshList")):e.$message.warning("取消失败："+t.msg)})},onChangeList:function(e){this.goodsList=e}}},m={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("el-row",[s("el-col",{attrs:{span:4}},[s("el-button",{attrs:{type:"primary"},on:{click:e.printSelectOrder}},[e._v("批量打印")])],1),e._v(" "),s("el-col",{attrs:{span:4}},[s("el-button",{attrs:{type:"primary"},on:{click:e.printAgain}},[e._v("重新打印")])],1)],1),e._v(" "),s("el-table",{staticStyle:{"min-width":"100%"},attrs:{data:e.orderList,stripe:"","max-height":"600"},on:{"selection-change":e.handleSelectionChange}},[s("el-table-column",{attrs:{type:"selection",width:"50",fixed:""}}),e._v(" "),s("el-table-column",{attrs:{type:"index",width:"50",fixed:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"buyId",label:"采购单编号","min-width":"100",fixed:"",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"buyerName",label:"采购商","min-width":"80",fixed:"",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"deliveryTime","min-width":"100",label:"配送日期",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"buySeq",label:"批次","min-width":"80",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(e.$dic.buySeqOptions[t.row.buySeq].label)+"\n            ")]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"status",label:"状态","min-width":"80",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(e.$dic.buyerOption[t.row.status])+"\n            ")]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"deliveryType",label:"配送方式","min-width":"100",sortable:""},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v("\n                "+e._s(e.$dic.deliveryTypeMap[t.row.deliveryType])+"\n            ")]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"genPrice",label:"总价预估","min-width":"100",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"buyTime",label:"下单时间","min-width":"140",sortable:""}}),e._v(" "),s("el-table-column",{attrs:{prop:"needNote",label:"需求信息","max-width":"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"remarks",label:"备注","max-width":"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"contact",label:"联系人","min-width":"80"}}),e._v(" "),s("el-table-column",{attrs:{prop:"telephone",label:"电话","min-width":"100"}}),e._v(" "),s("el-table-column",{attrs:{prop:"totalPrice",label:"操作",fixed:"right","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{round:"",size:"mini",type:"primary"},on:{click:function(s){return e.checkDetail(t.row)}}},[e._v("详情")]),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.handleDelete(t.row,t.$index)}}},[e._v("取消")])]}}])}),e._v(" "),s("el-table-column",{attrs:{prop:"totalPrice",label:"打印",fixed:"right","min-width":"120"},scopedSlots:e._u([{key:"default",fn:function(t){return[s("el-button",{attrs:{round:"",size:"mini",type:"primary"},on:{click:function(s){return e.printTable(t.row)}}},[e._v("打印")]),e._v(" "),s("el-button",{attrs:{type:"text"},on:{click:function(s){return e.printBuyOrder(t.row)}}},[e._v("飞鹅")])]}}])})],1),e._v(" "),s("el-dialog",{attrs:{title:"采购单详情",visible:e.dialogTableVisible,"before-close":e.buyOrderClose,width:"90%"},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[s("v-goods-table",{ref:"buyOrderInfo",attrs:{"goods-list":e.goodsList,title:e.checkedItem},on:{"change-list":e.onChangeList}})],1),e._v(" "),s("el-dialog",{attrs:{title:"采购单打印",visible:e.dialogPrint,width:"90%"},on:{"update:visible":function(t){e.dialogPrint=t}}},[s("v-print",{ref:"printOrderTable",attrs:{value:e.checkedItem,"concise-list":e.goodsList}})],1)],1)},staticRenderFns:[]},v={data:function(){return{request:new o.a,activeName:"first",pageSize:20,pageNo:1,total:0,layout:"total, sizes, prev, pager, next, jumper",options:this.$dic.buySeqOptions,purchaseList:[],queryForm:{deliveryTime:"",buySeq:"",buyerId:"",buyerStatus:"",buyId:"",buyerName:""}}},components:{vPurchaseTable:s("C7Lr")(p,m,!1,null,null,null).exports},watch:{},created:function(){this.handleCheck()},methods:{resetForm:function(e){this.$refs[e].resetFields()},handleCheck:function(){switch(this.activeName){case"first":this.fetchBuyOrderList()}},handlePageChange:function(e){this.pageSize=e.pageSize,this.pageNo=e.pageNo,this.fetchBuyOrderList()},handleClick:function(){},fetchBuyOrderList:function(){var e=this;this.request.fetchBuyOrderList({deliveryDate:this.queryForm.deliveryTime,buySeq:this.queryForm.buySeq,status:this.queryForm.buyerStatus,buyerId:this.queryForm.buyerId,buyId:this.queryForm.buyId,buyerName:this.queryForm.buyerName,pageSize:this.pageSize,pageNo:this.pageNo}).then(function(t){200===t.code?(e.purchaseList=t.list,e.total=t.totalRows):(e.purchaseList=[],e.$message.warning(t.msg))})}}},b={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("el-container",[s("div",{staticClass:"title"},[s("el-form",{ref:"queryForm",attrs:{model:e.queryForm,inline:!0},nativeOn:{submit:function(e){e.preventDefault()}}},[s("el-form-item",{attrs:{label:"配送日期:",prop:"deliveryTime"}},[s("el-date-picker",{staticClass:"date-field",attrs:{editable:!1,type:"date","value-format":"yyyy-MM-dd",placeholder:"选择日期"},model:{value:e.queryForm.deliveryTime,callback:function(t){e.$set(e.queryForm,"deliveryTime",t)},expression:"queryForm.deliveryTime"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"批次:",prop:"buySeq"}},[s("el-select",{staticClass:"small-select-field",attrs:{clearable:"",placeholder:"请选择"},model:{value:e.queryForm.buySeq,callback:function(t){e.$set(e.queryForm,"buySeq",t)},expression:"queryForm.buySeq"}},e._l(e.options,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"采购商:",prop:"buyerId"}},[s("buyer-check",{model:{value:e.queryForm.buyerId,callback:function(t){e.$set(e.queryForm,"buyerId",t)},expression:"queryForm.buyerId"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"状态:",prop:"buyerStatus"}},[s("el-select",{staticClass:"small-select-field",attrs:{clearable:"",filterable:"","default-first-option":"",placeholder:"请选择"},model:{value:e.queryForm.buyerStatus,callback:function(t){e.$set(e.queryForm,"buyerStatus",t)},expression:"queryForm.buyerStatus"}},e._l(e.$dic.buyerOptionLabel,function(e){return s("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}),1)],1),e._v(" "),s("el-form-item",{attrs:{label:"采购单编号:",prop:"buyId"}},[s("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"请输入"},model:{value:e.queryForm.buyId,callback:function(t){e.$set(e.queryForm,"buyId",t)},expression:"queryForm.buyId"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"采购商名称:",prop:"buyerName"}},[s("el-input",{staticStyle:{width:"150px"},attrs:{placeholder:"请输入"},model:{value:e.queryForm.buyerName,callback:function(t){e.$set(e.queryForm,"buyerName",t)},expression:"queryForm.buyerName"}})],1),e._v(" "),s("el-form-item",[s("el-button",{attrs:{type:"primary"},on:{click:e.handleCheck}},[e._v("查询\n                    ")]),e._v(" "),s("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.resetForm("queryForm")}}},[e._v("清空条件\n                    ")])],1)],1)],1),e._v(" "),s("el-main",[s("v-purchase-table",{attrs:{"order-list":e.purchaseList},on:{refreshList:e.fetchBuyOrderList}})],1),e._v(" "),s("el-footer",[s("div",{staticClass:"page-box"},[s("div"),e._v(" "),s("my-pagination",{attrs:{"page-size":e.pageSize,"current-page":e.pageNo,total:e.total,layout:e.layout,"page-sizes":[20,40,60,80]},on:{pagechange:e.handlePageChange}})],1)])],1)},staticRenderFns:[]};var y=s("C7Lr")(v,b,!1,function(e){s("Jw2/")},"data-v-ba1e3e6c",null);t.default=y.exports},Flkq:function(e,t){},"Jw2/":function(e,t){},g6EX:function(e,t){}});