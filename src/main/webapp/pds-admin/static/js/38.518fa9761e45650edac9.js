webpackJsonp([38],{"5M8h":function(e,t){},n58i:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("4YfN"),o=a.n(i),s=a("7tiM"),n=a("w4pF"),l={name:"basetable",data:function(){return{request:new n.a,loading:!1,elPagination:{pageNo:1,pageSize:20},total:0,inventoryList:[],checkedItem:{},warehouseList:[],payStatusOpt:s.a.payStatus,dialogTableVisible:!1,dialogTableVisible2:!1,checkNum:0,warehouseId:"",checkListId:"",goodsList:[],model:{payStatus:"",orderTime:""}}},created:function(){this._fetchInventoryList(),this._fetchWarehouseList()},computed:{adjustModel:function(){return{stockNum:this.checkNum,warehouseStockId:this.checkedItem.id}},checkedListModel:function(){return{warehouseStockId:this.checkListId}}},methods:{handleSizeChange:function(e){this.elPagination.pageSize=e,this._fetchInventoryList()},handleCurrentChange:function(e){this.elPagination.pageNo=e,this._fetchInventoryList()},confirm:function(e){var t=this;this.$utils.confirm(this,"你确认和仓库数量一致了吗？").then(function(){t._checkConfirm(e)})},adjust:function(e){this.checkedItem=e,this.dialogTableVisible2=!0},confirmAjust:function(){this.checkNum?(this._editInventory(),this.dialogTableVisible2=!1):this.$message.error("输入修改后的数量！")},fetchCheckList:function(e){this.dialogTableVisible=!0,this.checkListId=e,this._findGoodsCheckPage()},_fetchInventoryList:function(){var e=this;this.request.fetchInventoryList(o()({warehouseId:this.warehouseId},this.elPagination)).then(function(t){200==t.code?(e.inventoryList=t.list,e.total=t.totalRows):(e.inventoryList=[],e.$message.error(t.msg))})},_editInventory:function(){var e=this;this.request.editInventory(this.adjustModel).then(function(t){200==t.code?(e.$message.success("调整成功！"),e._fetchInventoryList()):e.$message.error(t.msg)})},_checkConfirm:function(e){var t=this;this.request.checkConfirm({warehouseStockId:e}).then(function(e){200==e.code?(t.$message.success("盘点成功！"),t._fetchInventoryList()):t.$message.error(e.msg)})},_findGoodsCheckPage:function(){var e=this;this.request.findGoodsCheckPage(this.checkedListModel).then(function(t){200==t.code?e.goodsList=t.list:(e.goodsList=[],e.$message.warning(t.msg))})},_fetchWarehouseList:function(){var e=this;this.request.fetchWarehouseList().then(function(t){200==t.code&&(e.warehouseList=t.list)})}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-tickets"}),e._v(" 商品盘点")])],1)],1),e._v(" "),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[e._v("\n            选择仓库："),a("el-select",{staticClass:"input",attrs:{placeholder:"请选择仓库"},model:{value:e.warehouseId,callback:function(t){e.warehouseId=t},expression:"warehouseId"}},e._l(e.warehouseList,function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})}),1)],1),e._v(" "),a("div",{staticClass:"handle-box"},[a("el-button",{attrs:{type:"primary",icon:"search"},on:{click:e._fetchInventoryList}},[e._v("查询\n            ")])],1)]),e._v(" "),a("div",{staticClass:"container marginTop"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{id:"aa",data:e.inventoryList,border:"","max-height":"600"}},[a("el-table-column",{attrs:{type:"index"}}),e._v(" "),a("el-table-column",{attrs:{prop:"goodsName",label:"商品名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"attr",label:"规格"}}),e._v(" "),a("el-table-column",{attrs:{prop:"unit",label:"单位"}}),e._v(" "),a("el-table-column",{attrs:{prop:"warehouseName",label:"仓库"}}),e._v(" "),a("el-table-column",{attrs:{prop:"stockNum",label:"库存数量"}}),e._v(" "),a("el-table-column",{attrs:{prop:"price",label:"价格"}}),e._v(" "),a("el-table-column",{attrs:{prop:"instockTime",label:"入库时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"lastInventoryTime",label:"上次盘点时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"order_info",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"search"},on:{click:function(a){return e.adjust(t.row)}}},[e._v("数量调整\n                    ")]),e._v(" "),a("el-button",{attrs:{type:"text",icon:"search"},on:{click:function(a){return e.fetchCheckList(t.row.id)}}},[e._v("盘点记录\n                    ")])]}}])})],1),e._v(" "),a("el-dialog",{attrs:{title:"盘点记录",visible:e.dialogTableVisible},on:{"update:visible":function(t){e.dialogTableVisible=t}}},[a("el-table",{attrs:{data:e.goodsList}},[a("el-table-column",{attrs:{property:"origNum",label:"原有库存"}}),e._v(" "),a("el-table-column",{attrs:{property:"modifyNum",label:"修改数量"}}),e._v(" "),a("el-table-column",{attrs:{property:"operator",label:"操作人员"}}),e._v(" "),a("el-table-column",{attrs:{property:"checkTime",label:"盘点时间",width:"200"}})],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dialogTableVisible=!1}}},[e._v("确 定\n                ")])],1)],1),e._v(" "),a("el-dialog",{attrs:{title:"数量盘点",width:"600px",visible:e.dialogTableVisible2},on:{"update:visible":function(t){e.dialogTableVisible2=t}}},[a("el-form",[a("el-form-item",{attrs:{label:"商品名称","label-width":"80px"}},[a("el-input",{attrs:{disabled:"",autocomplete:"off"},model:{value:e.checkedItem.goodsName,callback:function(t){e.$set(e.checkedItem,"goodsName",t)},expression:"checkedItem.goodsName"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"原有库存","label-width":"'80px'"}},[a("el-input",{attrs:{disabled:"",autocomplete:"off"},model:{value:e.checkedItem.stockNum,callback:function(t){e.$set(e.checkedItem,"stockNum",t)},expression:"checkedItem.stockNum"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"修改数量","label-width":"80px"}},[a("el-input",{attrs:{autocomplete:"off"},model:{value:e.checkNum,callback:function(t){e.checkNum=t},expression:"checkNum"}})],1)],1),e._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.dialogTableVisible2=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.confirmAjust}},[e._v("确 定")])],1)],1),e._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":e.elPagination.pageNo,"page-sizes":[20,30,40],"page-size":e.elPagination.pageSize,layout:"sizes, prev, pager, next",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange,"update:currentPage":function(t){return e.$set(e.elPagination,"pageNo",t)},"update:current-page":function(t){return e.$set(e.elPagination,"pageNo",t)}}})],1)],1)])},staticRenderFns:[]};var c=a("C7Lr")(l,r,!1,function(e){a("5M8h")},"data-v-4b84616e",null);t.default=c.exports}});