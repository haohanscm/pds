webpackJsonp([26],{MHex:function(t,e,o){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=o("w4pF"),s={data:function(){return{modelCode:"",warehouseId:"",tagsList:[],chooseItems:[],checkStatusList:[],request:new l.a,loading:!1}},props:{warehouseList:Array,value:Array,supplierId:String},mounted:function(){},computed:{goodsModel:function(){return{warehouseId:this.warehouseId,pageNo:1,pageSize:200}}},methods:{handelInputChange:function(){this._findStockGoodsPage()},handleSelect:function(t){this.warehouseId=t,console.log(t),this._findStockGoodsPage()},handleSelectionChange:function(t){var e=this;t.forEach(function(t){t.maxNum=t.stockNum,t.amount=+t.stockNum*(100*t.price)/100,e.value.push(t)}),this.$utils.fliterItem(this.value,"id")},isSelect:function(t){var e=this;t.forEach(function(t,o){console.log(e.value),-1!==e.$utils.findItem(e.value,t,"id")&&e.$refs.multipleTable.toggleRowSelection(t,!0)})},_findStockGoodsPage:function(){var t=this;this.loading=!0,console.log(this.goodsModel),this.request.findStockGoodsPage(this.goodsModel).then(function(e){200==e.code&&(t.chooseItems=e.list),t.loading=!1})}}},a={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",[o("el-row"),t._v(" "),o("div",{staticClass:"block"},[o("div",{staticClass:"block-left"},[o("el-menu",{staticClass:"sidebar-el-menu",attrs:{"background-color":"#fff","text-color":"#333","active-text-color":"#0000ff","unique-opened":""},on:{select:t.handleSelect}},[t._l(t.warehouseList,function(e){return[o("el-menu-item",{key:e.id,attrs:{index:e.id}},[o("span",{attrs:{slot:"title"},slot:"title"},[t._v(t._s(e.name))])])]})],2)],1),t._v(" "),o("div",{staticClass:"block-right"},[o("div",{staticClass:"block-item"},[o("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.chooseItems,"tooltip-effect":"dark"},on:{"selection-change":t.handleSelectionChange}},[o("el-table-column",{attrs:{type:"selection",width:"40"}}),t._v(" "),o("el-table-column",{attrs:{label:"商品编码",prop:"barCode",width:"120","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{label:"商品名",prop:"goodsName",width:"250","show-overflow-tooltip":""}}),t._v(" "),o("el-table-column",{attrs:{prop:"price",label:"价格",width:"120"}}),t._v(" "),o("el-table-column",{attrs:{prop:"attr",label:"规格"}}),t._v(" "),o("el-table-column",{attrs:{prop:"stockNum",label:"库存"}})],1)],1)])])],1)},staticRenderFns:[]};var i={name:"basetable",components:{vCheckGoods:o("C7Lr")(s,a,!1,function(t){o("a3m2")},"data-v-2668f3e4",null).exports},data:function(){return{categoryList:[],payTypeOpt:this.$dic.payType,request:new l.a,supplierId:"",supplierList:"",dialogVisible:!1,checkedList:[],model:{payStatus:"",orderTime:""},input2:"",warehouseList:[],payAmount:0,otherAmount:0,bizNote:"",stockStatus:"",payType:""}},created:function(){this._fetchSupplierList()},computed:{totalAmount:function(){var t=0;return this.checkedList.forEach(function(e){t+=+e.amount}),t},sumAmount:function(){return+this.totalAmount+ +this.otherAmount},returnModel:function(){return console.log(this.checkedList),this.checkedList.forEach(function(t){t.num=t.stockNum,t.stockNum,t.id=""}),{supplierId:this.supplierId,stockStatus:this.stockStatus,totalAmount:this.totalAmount,payAmount:this.payAmount,sumAmount:this.sumAmount,otherAmount:this.otherAmount,payType:this.payType,bizNote:this.bizNote,detailList:this.checkedList}}},methods:{handleSearchClick:function(){this.dialogVisible=!0,this._fetchWarehouseList()},handleNumChange:function(t,e){t.amount=(+t.stockNum*(100*+t.price)/100).toFixed(2),this.$set(this.checkedList,e,t)},removeItem:function(t){console.log(t),this.checkedList.splice(t,1)},handleCheckButton:function(){this._addReturnDetail()},_fetchSupplierList:function(){var t=this;this.request.fetchSupplierList().then(function(e){200==e.code&&(t.supplierList=e.ext)})},_fetchWarehouseList:function(){var t=this;this.request.fetchWarehouseList().then(function(e){200==e.code&&(t.warehouseList=e.list)})},_addReturnDetail:function(){var t=this;this.request.addReturnDetail(this.returnModel).then(function(e){200==e.code&&(t.$message.success("退货成功！"),t.checkedList=[])})}}},n={render:function(){var t=this,e=t.$createElement,o=t._self._c||e;return o("div",{staticClass:"table"},[o("div",{staticClass:"crumbs"},[o("el-breadcrumb",{attrs:{separator:"/"}},[o("el-breadcrumb-item",[o("i",{staticClass:"el-icon-tickets"}),t._v("新增退货")])],1)],1),t._v(" "),o("div",{staticClass:"container marginTop"},[o("div",{staticClass:"handle-box"},[t._v("\n            供应商："),o("el-select",{staticClass:"input",attrs:{placeholder:"请选择你要查询的供应状态"},model:{value:t.supplierId,callback:function(e){t.supplierId=e},expression:"supplierId"}},t._l(t.supplierList,function(t){return o("el-option",{key:t.id,attrs:{label:t.supplierName,value:t.id}})}),1)],1),t._v(" "),o("div",{staticClass:"handle-box"},[o("el-input",{attrs:{placeholder:"输入商品条形码","suffix-icon":""},model:{value:t.input2,callback:function(e){t.input2=e},expression:"input2"}},[o("i",{staticClass:"el-input__icon el-icon-search",staticStyle:{"background-color":"#eaeaea","margin-right":"-10px"},attrs:{slot:"suffix"},on:{click:t.handleSearchClick},slot:"suffix"})])],1),t._v(" "),o("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.checkedList,border:""}},[o("el-table-column",{attrs:{prop:"barCode",label:"商品编码"}}),t._v(" "),o("el-table-column",{attrs:{prop:"goodsName",label:"商品名称"}}),t._v(" "),o("el-table-column",{attrs:{prop:"unit",label:"单位"}}),t._v(" "),o("el-table-column",{attrs:{prop:"price",label:"单价"}}),t._v(" "),o("el-table-column",{attrs:{prop:"attr",label:"规格"}}),t._v(" "),o("el-table-column",{attrs:{prop:"amount",label:"总价格"}}),t._v(" "),o("el-table-column",{attrs:{prop:"stockNum",label:"数量",width:"150"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-input-number",{attrs:{size:"mini",min:0,max:e.row.maxNum,label:"描述文字"},on:{change:function(o){return t.handleNumChange(e.row,e.$index)}},model:{value:e.row.stockNum,callback:function(o){t.$set(e.row,"stockNum",o)},expression:"scope.row.stockNum"}})]}}])}),t._v(" "),o("el-table-column",{attrs:{prop:"instockTime",label:"入库时间"}}),t._v(" "),o("el-table-column",{attrs:{prop:"lastInventoryTime",label:"上次盘点时间"}}),t._v(" "),o("el-table-column",{attrs:{prop:"order_info",label:"操作"},scopedSlots:t._u([{key:"default",fn:function(e){return[o("el-button",{attrs:{type:"text"},on:{click:function(o){return t.removeItem(e.$index)}}},[t._v("移除")])]}}])})],1),t._v(" "),o("el-row",[o("el-col",{attrs:{span:5}},[t._v("\n                总计金额：￥"+t._s(t.totalAmount)+"\n            ")]),t._v(" "),o("el-col",{attrs:{span:5}},[t._v("\n                合计金额：￥"+t._s(t.sumAmount)+"\n            ")]),t._v(" "),o("el-col",{attrs:{span:5}},[t._v("\n                实付金额：￥"),o("el-input",{staticClass:"flex-1",model:{value:t.payAmount,callback:function(e){t.payAmount=e},expression:"payAmount"}})],1),t._v(" "),o("el-col",{attrs:{span:5}},[t._v("\n                其他费用：￥"),o("el-input",{staticClass:"flex-1",model:{value:t.otherAmount,callback:function(e){t.otherAmount=e},expression:"otherAmount"}})],1),t._v(" "),o("el-col",{attrs:{span:6}},[t._v("\n                支付方式："),o("el-select",{staticClass:"flex-1",attrs:{placeholder:"请选择你要查询的订单状态"},model:{value:t.payType,callback:function(e){t.payType=e},expression:"payType"}},t._l(t.payTypeOpt,function(t){return o("el-option",{key:t.value,attrs:{label:t.label,value:t.value}})}),1)],1),t._v(" "),o("el-col",{attrs:{span:6}},[t._v("\n                备注："),o("el-input",{staticClass:"flex-1",model:{value:t.bizNote,callback:function(e){t.bizNote=e},expression:"bizNote"}})],1),t._v(" "),o("el-col",{attrs:{span:5}}),t._v(" "),o("el-col",{attrs:{span:5}},[o("el-button",{attrs:{type:"primary"},on:{click:t.handleCheckButton}},[t._v("退货")])],1)],1),t._v(" "),o("el-dialog",{attrs:{title:"选择你要退货的商品",visible:t.dialogVisible,width:"50%"},on:{"update:visible":function(e){t.dialogVisible=e}}},[o("v-check-goods",{attrs:{"warehouse-list":t.warehouseList,supplierId:t.supplierId},model:{value:t.checkedList,callback:function(e){t.checkedList=e},expression:"checkedList"}}),t._v(" "),o("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[o("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),o("el-button",{attrs:{type:"primary"},on:{click:function(e){t.dialogVisible=!1}}},[t._v("确 定")])],1)],1)],1)])},staticRenderFns:[]};var c=o("C7Lr")(i,n,!1,function(t){o("Q0Og")},"data-v-72ac8d40",null);e.default=c.exports},Q0Og:function(t,e){},a3m2:function(t,e){}});