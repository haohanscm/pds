webpackJsonp([32],{OG0C:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("aA9S"),s=a.n(i),n=a("7tiM"),l=a("cWdR"),o=a("W2Dm"),r={name:"basetable",components:{vClassification:l.a},data:function(){return{payStatusOpt:n.a.payStatus,deliveryStatus:n.a.deliveryStatus,loading:!1,planListModel:{pageNo:1,pageSize:30,shopId:"",orderId:"",goodsId:"",districtArea:"",communityId:"",memberName:""},countData:{},dialogVisible:!1,shopList:[],areaList:[],deliveryManList:[],date:[],planList:[],planListChecked:[],visible1:!1,faceTo:"",total:0,checkedStatus:"1",checkedPlan:"",visible2:[],request:new o.a}},created:function(){var t=this;this.getCountData(),this.getPlanList(),setTimeout(function(){t.getShopList(),t.getAreaList(),t.getDeliveryManList()},0)},mounted:function(){for(var t=0;t<50;t++)this.visible2.push(!1)},computed:{listModel:function(){var t={beginDate:this.date[0],endDate:this.date[1]};return s()(t,this.planListModel)},deliveryManChangeModel:function(){for(var t=[],e=this.planListChecked.length-1;e>-1;e--)t.push(this.planListChecked[e].id);return{deliveryPlanIds:t,deliveryManId:this.faceTo}},deliveryManToCheck:function(){var t=this,e=[];return this.deliveryManList.forEach(function(a,i){a.id&&a.id!=t.planListModel.deliveryManId&&e.push(a)}),e},changePlanStatusModel:function(){return{status:this.checkedStatus,deliveryPlanId:this.checkedPlan}}},methods:{getShopList:function(){var t=this;this.fetchShopList().then(function(e){200==e.code&&(t.shopList=e.ext,t.shopList.push({id:"",shopName:"全部"}))})},getAreaList:function(){var t=this;this.fetchAreaList().then(function(e){200==e.code&&(t.areaList=e.list,t.areaList.push({id:"",name:"全部"}))})},getDeliveryManList:function(){var t=this;this.fetchDeliveryManList().then(function(e){200==e.code&&(t.deliveryManList=e.ext,t.deliveryManList.push({id:"",realName:"全部"}))})},getPlanList:function(){var t=this;this.loading=!0,this.deliveryPlanList().then(function(e){200==e.code&&(t.total=e.totalRows,t.planList=e.list)}).finally(function(e){t.loading=!1})},handleSelectionChange:function(t){this.planListChecked=t},assignTo:function(){var t=this;this.changeDeliveryMan().then(function(e){200==e.code?(t.$utils.showSuccess(t,"更改成功"),t.visible1=!1):(t.$utils.showErr(t,e.msg),t.visible1=!1)}),this.getPlanList()},getCountData:function(){var t=this;this.querySumaryCount().then(function(e){200==e.code&&(t.countData=e.ext)})},changeStatus:function(t,e){var a=this;this.checkedPlan=e,this.changePlanStatus().then(function(e){200==e.code?(a.$utils.showSuccess(a,"更改成功"),a.$set(a.visible2,t,!1)):(a.$utils.showErr(a,e.msg),a.$set(a.visible2,t,!1))}).finally(function(t){a.getPlanList()})},handleSizeChange:function(t){this.planListModel.pageSize=t,this.getPlanList()},handleCurrentChange:function(t){this.planListModel.pageNo=t,this.getPlanList()},fetchShopList:function(){return this.request.fetchShopList()},fetchAreaList:function(){return this.request.fetchAreaList({pageNo:1,pageSize:100})},fetchDeliveryManList:function(){return this.request.fetchDeliveryManList()},deliveryPlanList:function(){return this.request.deliveryPlanList(this.listModel)},changeDeliveryMan:function(){return this.request.changeDeliveryMan(this.deliveryManChangeModel)},querySumaryCount:function(){return this.request.querySummaryCount()},changePlanStatus:function(){return this.request.changePlanStatus(this.changePlanStatusModel)}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"table"},[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-tickets"}),t._v(" 配送订单查询")])],1)],1),t._v(" "),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[t._v("\n            店铺："),a("el-select",{staticClass:"input",attrs:{placeholder:"请选择你要查询的订单状态"},model:{value:t.planListModel.shopId,callback:function(e){t.$set(t.planListModel,"shopId",e)},expression:"planListModel.shopId"}},t._l(t.shopList,function(t){return a("el-option",{key:t.id,attrs:{label:t.shopName,value:t.id}})}),1)],1),t._v(" "),a("div",{staticClass:"handle-box"},[t._v("\n            片区："),a("el-select",{staticClass:"input",attrs:{placeholder:"请选择你要查询的订单状态"},model:{value:t.planListModel.districtArea,callback:function(e){t.$set(t.planListModel,"districtArea",e)},expression:"planListModel.districtArea"}},t._l(t.areaList,function(t){return a("el-option",{key:t.id,attrs:{label:t.name,value:t.id}})}),1)],1),t._v(" "),a("div",{staticClass:"handle-box"},[t._v("    \n            配送员："),a("el-select",{staticClass:"input",attrs:{placeholder:"请选择你要查询的订单状态"},model:{value:t.planListModel.deliveryManId,callback:function(e){t.$set(t.planListModel,"deliveryManId",e)},expression:"planListModel.deliveryManId"}},t._l(t.deliveryManList,function(t){return a("el-option",{key:t.id,attrs:{label:t.realName,value:t.id}})}),1)],1),t._v(" "),a("div",{staticClass:"handle-box"},[a("div",{staticStyle:{display:"inline"}},[a("span",{staticClass:"demonstration"},[t._v("订单日期：")]),t._v(" "),a("el-date-picker",{attrs:{type:"daterange",format:"yyyy-MM-dd","value-format":"yyyy-MM-dd","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期"},model:{value:t.date,callback:function(e){t.date=e},expression:"date"}})],1),t._v(" "),a("el-button",{attrs:{type:"primary",icon:"search"},on:{click:t.getPlanList}},[t._v("查询")])],1),t._v(" "),a("div",{staticClass:"handle-box"},[a("el-dropdown",[a("el-popover",{attrs:{placement:"right",width:"400",trigger:"click"},model:{value:t.visible1,callback:function(e){t.visible1=e},expression:"visible1"}},[a("div",t._l(t.deliveryManToCheck,function(e){return a("el-radio",{key:e.id,attrs:{label:e.id},model:{value:t.faceTo,callback:function(e){t.faceTo=e},expression:"faceTo"}},[t._v(t._s(e.realName))])}),1),t._v(" "),a("el-button",{staticStyle:{"margin-right":"30px",float:"right"},attrs:{type:"primary",icon:"search"},on:{click:t.assignTo}},[t._v("确认")]),t._v(" "),a("el-button",{attrs:{slot:"reference",type:"primary"},slot:"reference"},[t._v("指派已标记订单给")])],1)],1)],1),t._v(" "),a("div",{staticClass:"delivery-nav"},[a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v("今日配送总数")]),t._v(" "),a("div",{staticClass:"item-cont"},[t._v(t._s(t.countData.totalNum))])]),t._v(" "),a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v("已配送订单数")]),t._v(" "),a("div",{staticClass:"item-cont"},[t._v(t._s(t.countData.successNum))])]),t._v(" "),a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v("未配送订单数")]),t._v(" "),a("div",{staticClass:"item-cont"},[t._v(t._s(t.countData.waitNum))])]),t._v(" "),a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v("待处理订单数")]),t._v(" "),a("div",{staticClass:"item-cont"},[t._v(t._s(t.countData.failedNum))])]),t._v(" "),a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v("今日配送小区数")]),t._v(" "),a("div",{staticClass:"item-cont"},[t._v(t._s(t.countData.communityNum))])]),t._v(" "),a("div",{staticClass:"item"},[a("div",{staticClass:"item-title"},[t._v("今日配送客户数")]),t._v(" "),a("div",{staticClass:"item-cont"},[t._v(t._s(t.countData.memberNum))])])])]),t._v(" "),a("div",{staticClass:"container marginTop"},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{fit:"",data:t.planList,border:""},on:{"selection-change":t.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",width:"55"}}),t._v(" "),a("el-table-column",{attrs:{prop:"theDay",label:"配送日期",fit:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"shopName",label:"店铺名称",fit:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"memberName",label:"客户信息",fit:""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-popover",{attrs:{trigger:"hover",placement:"left"}},[a("p",[t._v("姓名: "+t._s(e.row.memberName))]),t._v(" "),a("p",[t._v("电话: "+t._s(e.row.memberContact))]),t._v(" "),a("p",[t._v("住址: "+t._s(e.row.address))]),t._v(" "),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v(t._s(e.row.memberName))])],1)]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"",label:"商品信息","min-width":"300",fit:""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(e.row.goodsName+" x "+e.row.goodsNum+(e.row.goodsUnit||"")+(e.row.goodsInfo||"")))]),t._v(" "),e.row.giftName?a("div",[t._v(t._s(e.row.giftName+" x 1"+(e.row.giftUnit||"")+(e.row.giftInfo||"")))]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"deliveryManName",label:"配送员姓名",fit:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"deliverManTel",label:"配送员电话",fit:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"updateDate",label:"更新时间",fit:""}}),t._v(" "),a("el-table-column",{attrs:{prop:"pay_status",label:"配送状态",fit:""},scopedSlots:t._u([{key:"default",fn:function(e){return[a("div",[t._v(t._s(t.deliveryStatus[e.row.status].label)+"\n                        "),a("el-popover",{attrs:{placement:"right",width:"400",trigger:"click"},model:{value:t.visible2[e.$index],callback:function(a){t.$set(t.visible2,e.$index,a)},expression:"visible2[scope.$index]"}},[a("div",t._l(t.deliveryStatus,function(e){return a("el-radio",{key:e.value,attrs:{label:e.value},model:{value:t.checkedStatus,callback:function(e){t.checkedStatus=e},expression:"checkedStatus"}},[t._v(t._s(e.label))])}),1),t._v(" "),a("el-button",{staticStyle:{"margin-right":"30px",float:"right"},attrs:{type:"primary",icon:"search"},on:{click:function(a){return t.changeStatus(e.$index,e.row.id)}}},[t._v("确认")]),t._v(" "),a("el-button",{attrs:{slot:"reference",type:"text"},slot:"reference"},[t._v("更改")])],1)],1)]}}])})],1),t._v(" "),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"","current-page":t.planListModel.pageNo,"page-sizes":[30,40,50],layout:"sizes, prev, pager, next",total:t.total},on:{"size-change":t.handleSizeChange,"current-change":t.handleCurrentChange,"update:currentPage":function(e){return t.$set(t.planListModel,"pageNo",e)},"update:current-page":function(e){return t.$set(t.planListModel,"pageNo",e)}}})],1)],1)])},staticRenderFns:[]};var d=a("C7Lr")(r,c,!1,function(t){a("ufMh")},"data-v-a855340c",null);e.default=d.exports},ufMh:function(t,e){}});