webpackJsonp([13,22],{"7Ncb":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i("7tiM"),n=i("uAIv"),a=i("W2Dm"),s=(i("8+FI"),{name:"basetable",components:{communityEdit:n.default},data:function(){return{payStatusOpt:o.a.payStatus,model:{payStatus:"",orderTime:""},request:new a.a,total:0,areaList:[]}},created:function(){this.getAreasList()},methods:{getAreasList:function(){var t=this;this.request.fetchAreaList({pageNo:1,pageSize:10}).then(function(e){200==e.code&&(t.areaList=e.list,t.total=e.totalRows)})},delDistrictArea:function(t,e){var i=this;this.$utils.confirm(this,"你确认要删除该片区吗？").then(function(){i.request.delDistrictArea({id:e}).then(function(e){200==e.code?(i.areaList.splice(t,1),i.$utils.showSuccess(i,"删除成功")):i.$utils.showError(i,e.msg)})})},handleEdit:function(t){this.$router.push({path:"/delivery/community_edit",query:{item:t,isEdit:!0}})},handleCurrentChange:function(){}}}),r={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"table"},[i("div",{staticClass:"crumbs"},[i("el-breadcrumb",{attrs:{separator:"/"}},[i("el-breadcrumb-item",[i("i",{staticClass:"el-icon-tickets"}),t._v(" 小区-区域统计")])],1)],1),t._v(" "),i("div",{staticClass:"container marginTop"},[i("div",{staticClass:"handle-box"},[i("router-link",{attrs:{to:{path:"/delivery/community_edit",query:{isEdit:!1}}}},[i("el-button",{attrs:{type:"primary"}},[t._v("+ 新增片区")])],1)],1),t._v(" "),i("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:t.areaList,border:""}},[i("el-table-column",{attrs:{prop:"name",label:"片区名称",width:"200"}}),t._v(" "),i("el-table-column",{attrs:{prop:"provinceName",label:"省/直辖市",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"cityName",label:"市",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"regionName",label:"区",width:"100"}}),t._v(" "),i("el-table-column",{attrs:{prop:"merchantName",label:"所属店铺"}}),t._v(" "),i("el-table-column",{attrs:{prop:"communityNames",label:"包含小区"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-popover",{attrs:{trigger:"hover",placement:"right"}},[i("p",{staticStyle:{display:"block","max-width":"200px"}},[t._v(t._s(e.row.communityNames))]),t._v(" "),i("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[i("div",{staticClass:"single-line cursor-pointer"},[t._v(t._s(e.row.communityNames))])])])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"createDate",label:"创建时间"}}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"180"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"mini"},on:{click:function(i){return t.handleEdit(e.row)}}},[t._v("编辑")]),t._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return t.delDistrictArea(e.row.$index,e.row.id)}}},[t._v("删除")])]}}])})],1)],1)])},staticRenderFns:[]};var l=i("C7Lr")(s,r,!1,function(t){i("TveZ")},"data-v-fba0b93e",null);e.default=l.exports},TveZ:function(t,e){},cBYe:function(t,e){},uAIv:function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=i("7tiM"),n=i("W2Dm"),a=(i("8+FI"),i("Yarq")),s=i.n(a),r=i("AA3o"),l=i.n(r),d=i("UzKs"),c=i.n(d),u=i("Y7Ml"),m=i.n(u),h=function(t){function e(){return l()(this,e),c()(this,(e.__proto__||s()(e)).call(this))}return m()(e,t),e}(i("FdFV").a),v={data:function(){return{tagsList:[],provenceId:"",request:new h,notCheck:!1}},props:{value:Object,provenceList:Array,cityList:Array,regionList:Array},mounted:function(){},methods:{clearCity:function(t){t&&(this.value.cityCode="",this.value.regionCode="",this.value.provinceCode=""),this.getProvence()},getProvence:function(){var t=this;this.request.fetchAddress(this.value).then(function(e){200==e.code&&(t.provenceList=e.ext)})},getCity:function(){var t=this;this.request.fetchAddress(this.value).then(function(e){200==e.code&&(t.cityList=e.ext),t.value.cityCode="",t.value.regionCode="",t.regionList=[]})},getRegion:function(){var t=this;this.request.fetchAddress(this.value).then(function(e){200==e.code&&(t.regionList=e.ext),t.value.regionCode=""})}}},y={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"block"},[i("div",{staticClass:"item"},[t._v("\n        所属省份："),i("el-select",{staticStyle:{flex:"1"},attrs:{placeholder:"请选择省份"},on:{change:t.getCity,"visible-change":t.clearCity},model:{value:t.value.provinceCode,callback:function(e){t.$set(t.value,"provinceCode",e)},expression:"value.provinceCode"}},t._l(t.provenceList,function(t){return i("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})}),1)],1),t._v(" "),i("div",{staticClass:"item"},[t._v("\n        所属城市："),i("el-select",{staticStyle:{flex:"1"},attrs:{placeholder:"请选择城市"},on:{change:t.getRegion},model:{value:t.value.cityCode,callback:function(e){t.$set(t.value,"cityCode",e)},expression:"value.cityCode"}},t._l(t.cityList,function(t){return i("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})}),1)],1),t._v(" "),i("div",{staticClass:"item"},[t._v("\n        所属区县："),i("el-select",{staticStyle:{flex:"1"},attrs:{placeholder:"请选择区县"},on:{change:t.checkOver},model:{value:t.value.regionCode,callback:function(e){t.$set(t.value,"regionCode",e)},expression:"value.regionCode"}},t._l(t.regionList,function(t){return i("el-option",{key:t.code,attrs:{label:t.name,value:t.code}})}),1)],1)])},staticRenderFns:[]};var p={name:"basetable",components:{regionalChoice:i("C7Lr")(v,y,!1,function(t){i("cBYe")},"data-v-7e3c95c4",null).exports},data:function(){return{payStatusOpt:o.a.payStatus,addressObj:{provinceCode:"",cityCode:"",regionCode:""},model:{id:""},editDistrictAreaModel:{id:"",name:"",province:"",city:"",region:""},addDistrictAreaModel:{name:"",province:"",city:"",region:"",communityIds:""},getCommunityModel:{districtId:""},delCommunityModel:{districtId:"",communityId:""},editCommunityModel:{districtId:"",communityName:"",communityId:""},addCommunityModel:{districtId:"",communityNames:[]},communityList:[],request:new n.a,areaData:{},dialogModify:!1,choosedIndex:"",inputVisible:!1,inputValue:"",addCommunityName:"",isEdit:!0}},created:function(){this.renderArea()},mounted:function(){},computed:{data:function(){return this.areaData}},methods:{renderArea:function(){var t=this.$route.query.item;this.isEdit=this.$route.query.isEdit,this.isEdit&&(this.areaData=t,this.model.id=t.id,this.delCommunityModel.districtId=t.id,this.editCommunityModel.districtId=t.id,this.addCommunityModel.districtId=t.id,this.editDistrictAreaModel.id=t.id,this.getCommunityModel.districtId=t.id,this.provenceList=[{code:t.province,name:t.provinceName}],this.cityList=[{code:t.city,name:t.cityName}],this.regionList=[{code:t.region,name:t.regionName}],this.addressObj.provinceCode=t.province,this.addressObj.cityCode=t.city,this.addressObj.regionCode=t.region)},getAddress:function(t){console.log(t)},getCommunityName:function(){this.addCommunityModel.communityNames.push(this.addCommunityName),this.addCommunityName=""},delCommunityName:function(t){this.addCommunityModel.communityNames.splice(t,1)},openDialogModify:function(t,e,i){this.dialogModify=!0,this.editCommunityModel.communityId=i,this.editCommunityModel.communityName=e,this.choosedIndex=t},handleClose:function(t){this.addCommunityModel.communityNames.splice(this.addCommunityModel.communityNames.indexOf(t),1)},showInput:function(){var t=this;this.inputVisible=!0,this.$nextTick(function(e){t.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm:function(){var t=this.inputValue;t&&this.addCommunityModel.communityNames.push(t),this.inputVisible=!1,this.inputValue=""},editDistrictArea:function(){var t=this;this.editDistrictAreaModel.name=this.areaData.name,this.editDistrictAreaModel.province=this.addressObj.provinceCode,this.editDistrictAreaModel.city=this.addressObj.cityCode,this.editDistrictAreaModel.region=this.addressObj.regionCode,this.request.editDistrictArea(this.editDistrictAreaModel).then(function(e){200==e.code&&(t.$utils.showSuccess(t,"添加成功！"),t.$router.push("/delivery/community"))})},addDistrictArea:function(){var t=this,e="";this.communityList.forEach(function(t,i){0==i&&(e+=t.id),e+=","+t.id}),this.addDistrictAreaModel.name=this.areaData.name,this.addDistrictAreaModel.province=this.addressObj.provinceCode,this.addDistrictAreaModel.city=this.addressObj.cityCode,this.addDistrictAreaModel.region=this.addressObj.regionCode,this.addDistrictAreaModel.communityIds=e,this.request.addDistrictArea(this.addDistrictAreaModel).then(function(e){200==e.code?(t.$router.go(-1),t.$utils.showSuccess(t,"添加成功！")):t.$utils.showError(t,e.msg)})},editCommunity:function(){var t=this;this.request.editCommunity(this.editCommunityModel).then(function(e){200==e.code?(t.communityList[t.choosedIndex].name=t.editCommunityModel.communityName,t.dialogModify=!1):t.$utils.showError(t,e.msg)})},fetchCommunityList:function(){var t=this;this.getCommunityModel.queryUnSelected=!this.isEdit,this.request.fetchCommunityList(this.getCommunityModel).then(function(e){200==e.code?t.communityList=e.ext:t.$utils.showError(t,e.msg)})},delCommunity:function(t,e){var i=this;this.$utils.confirm(this,"你确认要删除该小区吗？").then(function(){i.delCommunityModel.communityId=e,i.request.delCommunity(i.delCommunityModel).then(function(e){200==e.code?(i.communityList.splice(t,1),i.$utils.showSuccess(i,"删除成功")):i.$utils.showError(i,e.msg)})})},addCommunity:function(){var t=this;this.request.addCommunity(this.addCommunityModel).then(function(e){200==e.code?(t.$utils.showSuccess(t,"添加成功"),t.addCommunityModel.communityNames=[],t.fetchCommunityList()):t.$utils.showError(t,e.msg)})}}},f={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"table"},[i("div",{staticClass:"crumbs"},[i("el-breadcrumb",{attrs:{separator:"/"}},[i("el-breadcrumb-item",[i("i",{staticClass:"el-icon-tickets"}),t._v(" 区域修改/新增")])],1)],1),t._v(" "),i("div",{staticClass:"container marginTop"},[i("div",{staticClass:"item"},[t._v("\n            片区名称："),i("el-input",{staticStyle:{flex:"1"},attrs:{placeholder:"请输入内容"},model:{value:t.areaData.name,callback:function(e){t.$set(t.areaData,"name",e)},expression:"areaData.name"}},[t._v("\n                "+t._s(t.data)+"\n            ")])],1),t._v(" "),i("div",{staticClass:"item",staticStyle:{margin:"0 auto"}},[i("regional-choice",{attrs:{"provence-list":t.provenceList,"city-list":t.cityList,"region-list":t.regionList},model:{value:t.addressObj,callback:function(e){t.addressObj=e},expression:"addressObj"}})],1),t._v(" "),i("div",{staticClass:"item"},[i("el-collapse",{staticStyle:{width:"100%"},on:{change:t.fetchCommunityList}},[i("el-collapse-item",{attrs:{title:"包含小区：",name:"1"}},[i("el-table",{ref:"multipleTable",attrs:{data:t.communityList,border:""}},[i("el-table-column",{attrs:{label:"序号",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                                "+t._s(e.$index+1)+"\n                            ")]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"小区名称"}}),t._v(" "),i("el-table-column",{attrs:{prop:"createDate",label:"创建时间"}}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",{staticStyle:{display:"flex"}},[i("el-button",{on:{click:function(i){return t.openDialogModify(e.$index,e.row.name,e.row.id)}}},[t._v("修改小区名")]),t._v(" "),i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return t.delCommunity(e.$index,e.row.id)}}},[t._v("删除")])],1)]}}])})],1),t._v(" "),i("div",{staticStyle:{margin:"30px 0 30px 0","border-top":"1px solid #eaeaea"}}),t._v(" "),i("el-table",{directives:[{name:"show",rawName:"v-show",value:t.addCommunityModel.communityNames[0],expression:"addCommunityModel.communityNames[0]"}],ref:"multipleTable",attrs:{data:t.addCommunityModel.communityNames,border:""}},[i("el-table-column",{attrs:{label:"序号",width:"140"},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n                                "+t._s(e.$index+1)+"\n                            ")]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"name",label:"小区名称"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("div",[t._v("\n                                    "+t._s(e.row)+"\n                                ")])]}}])}),t._v(" "),i("el-table-column",{attrs:{prop:"createDate",label:"创建时间"}}),t._v(" "),i("el-table-column",{attrs:{label:"操作",width:"200"},scopedSlots:t._u([{key:"default",fn:function(e){return[i("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(i){return t.delCommunityName(e.$index)}}},[t._v("移除")])]}}])})],1),t._v(" "),i("div",{staticClass:"item",staticStyle:{width:"100%"}},[i("div",{staticClass:"handle-box",staticStyle:{display:"flex"}},[t._v("    \n                                新增小区："),i("el-input",{staticStyle:{flex:"1"},attrs:{placeholder:"输入完后按回车"},on:{change:t.getCommunityName},model:{value:t.addCommunityName,callback:function(e){t.addCommunityName=e},expression:"addCommunityName"}}),t._v(" "),i("el-button",{attrs:{size:"small",plain:""},on:{click:t.getCommunityName}},[t._v("添加小区")])],1)]),t._v(" "),i("el-button",{on:{click:t.addCommunity}},[t._v("确认添加")])],1)],1),t._v(" "),i("el-dialog",{attrs:{title:"小区名输入",width:"30%",visible:t.dialogModify},on:{"update:visible":function(e){t.dialogModify=e}}},[i("el-input",{attrs:{placeholder:"请输入新的小区名称",autocomplete:"off"},model:{value:t.editCommunityModel.communityName,callback:function(e){t.$set(t.editCommunityModel,"communityName",e)},expression:"editCommunityModel.communityName"}}),t._v(" "),i("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{on:{click:function(e){t.dialogModify=!1}}},[t._v("取 消")]),t._v(" "),i("el-button",{attrs:{type:"primary"},on:{click:t.editCommunity}},[t._v("确 定")])],1)],1)],1),t._v(" "),i("div",{staticClass:"item"},[t.isEdit?i("el-button",{attrs:{type:"primary",plain:"",size:"medium"},on:{click:t.editDistrictArea}},[t._v("修改片区")]):t._e(),t._v(" "),t.isEdit?t._e():i("el-button",{attrs:{type:"primary",plain:"",size:"medium"},on:{click:t.addDistrictArea}},[t._v("新增片区")])],1)])])},staticRenderFns:[]};var C=i("C7Lr")(p,f,!1,function(t){i("yvmX")},"data-v-acc225bc",null);e.default=C.exports},yvmX:function(t,e){}});